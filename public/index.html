<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NextDev MP3 Player</title>
  <style>
    body {
      font-family: sans-serif;
      background: #222;
      color: #fff;
      text-align: center;
      padding: 20px;
    }
    .player {
      margin-top: 20px;
    }
    #playlist li {
      cursor: pointer;
      margin: 5px;
      color: #00f0ff;
    }
    .controls, .equalizer, .chatbot {
      margin: 20px 0;
    }
    input[type="range"] {
      width: 100px;
    }
    .theme-light {
      background: #f0f0f0;
      color: #111;
    }
  </style>
</head>
<body>
  <h1>üéß NextDev MP3 Player</h1>

  <div class="player">
    <audio id="player" controls></audio>
  </div>

  <ul id="playlist">
    <li data-src="song1.mp3">Track 1 - Relaxing Beats</li>
    <li data-src="song2.mp3">Track 2 - Energize</li>
    <li data-src="song3.mp3">Track 3 - Chill Vibes</li>
  </ul>

  <div class="controls">
    <button id="playPauseBtn">‚ñ∂Ô∏è</button>
    <button onclick="stopAudio()">‚èπÔ∏è</button>
    <label>Volume: <input type="range" id="volume" min="0" max="1" step="0.01"></label>
  </div>

  <div class="equalizer">
    <h3>Equalizer</h3>
    <label>Bass <input type="range" id="bass" min="-30" max="30"></label>
    <label>Mid <input type="range" id="mid" min="-30" max="30"></label>
    <label>Treble <input type="range" id="treble" min="-30" max="30"></label>
    <br>
    <label>Crossfade (sec): <input type="range" id="crossfade" min="0" max="30" value="0"></label>
  </div>

  <div class="chatbot">
    <h3>üé§ Ask Me Something</h3>
    <input type="text" id="chatInput" placeholder="E.g., play a relaxing song">
    <button onclick="handleChat()">Send</button>
    <p id="chatResponse"></p>
  </div>

  <button onclick="toggleTheme()">üåì Toggle Theme</button>

  <script>
    const audio = document.getElementById('player');
    const playPauseBtn = document.getElementById('playPauseBtn');
    const playlist = document.getElementById('playlist');
    const volumeSlider = document.getElementById('volume');
    const chatResponse = document.getElementById('chatResponse');
    let currentTrack = null;
    let isPlaying = false;

    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
    const source = audioContext.createMediaElementSource(audio);
    const bassEQ = audioContext.createBiquadFilter();
    bassEQ.type = "lowshelf";
    bassEQ.frequency.value = 100;
    const midEQ = audioContext.createBiquadFilter();
    midEQ.type = "peaking";
    midEQ.frequency.value = 1000;
    const trebleEQ = audioContext.createBiquadFilter();
    trebleEQ.type = "highshelf";
    trebleEQ.frequency.value = 3000;
    source.connect(bassEQ).connect(midEQ).connect(trebleEQ).connect(audioContext.destination);

    document.getElementById("bass").oninput = (e) => bassEQ.gain.value = e.target.value;
    document.getElementById("mid").oninput = (e) => midEQ.gain.value = e.target.value;
    document.getElementById("treble").oninput = (e) => trebleEQ.gain.value = e.target.value;

    playPauseBtn.addEventListener('click', () => {
      if (!currentTrack) return;
      if (audio.paused) {
        audio.play();
        isPlaying = true;
        playPauseBtn.textContent = '‚è∏Ô∏è';
      } else {
        audio.pause();
        isPlaying = false;
        playPauseBtn.textContent = '‚ñ∂Ô∏è';
      }
    });

    playlist.addEventListener('click', (e) => {
      if (e.target.tagName === 'LI') {
        const src = e.target.dataset.src;
        if (src !== currentTrack) {
          fadeOut(() => {
            audio.src = src;
            currentTrack = src;
            audio.play();
            isPlaying = true;
            playPauseBtn.textContent = '‚è∏Ô∏è';
          });
        } else {
          audio.paused ? audio.play() : audio.pause();
        }
      }
    });

    volumeSlider.addEventListener('input', (e) => {
      audio.volume = e.target.value;
    });

    function stopAudio() {
      audio.pause();
      audio.currentTime = 0;
      isPlaying = false;
      playPauseBtn.textContent = '‚ñ∂Ô∏è';
    }

    function fadeOut(callback) {
      const fadeTime = parseFloat(document.getElementById('crossfade').value);
      if (!fadeTime) return callback();
      const initialVol = audio.volume;
      let t = fadeTime;
      const interval = setInterval(() => {
        if (t <= 0) {
          clearInterval(interval);
          callback();
          audio.volume = initialVol;
        } else {
          audio.volume = (t / fadeTime) * initialVol;
          t -= 0.1;
        }
      }, 100);
    }

    function handleChat() {
      const input = document.getElementById('chatInput').value.toLowerCase();
      let response = 'ü§ñ Sorry, I didn\'t understand that.';
      if (input.includes('play') && input.includes('relax')) {
        document.querySelector('[data-src="song1.mp3"]').click();
        response = 'üé∂ Playing a relaxing track for you.';
      } else if (input.includes('what') && input.includes('playing')) {
        response = currentTrack ? `üéµ Currently playing: ${currentTrack}` : 'Nothing is playing.';
      } else if (input.includes('increase volume')) {
        audio.volume = Math.min(1, audio.volume + 0.1);
        response = 'üîä Volume increased.';
      } else if (input.includes('dr dre')) {
        response = 'üé§ "Rat Tat Tat" by Dr. Dre was composed by Dr. Dre, Snoop Dogg, and Sam Sneed.';
      }
      chatResponse.textContent = response;
    }

    function toggleTheme() {
      document.body.classList.toggle('theme-light');
    }
  </script>
</body>
</html>
